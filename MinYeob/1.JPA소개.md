# SQL 중심적인 개발의 문제점

#### 현재 대다수의 어플리케이션은 객체를 관계형 DB에 관리한다.

허나, 애초에 관계형 데이터베이스 사상과 객체 지향 사상이 다르다.
즉, 패러다임의 불일치가 일어나게 되는데  
관계형 DB는 데이터를 정규화 해서 보관을 하는게 목표이고,  
객체는 필드와 메서드를 잘 묶어 캡슐화 해서 사용하는게 목표이다.

현재 객체를 영구 보관하는 다양한 저장소는 RDB,NOSQL(아직까지 메인이 되지 않음),FILE(검색을 못함) 등이 있지만  
현실적인 대안은 결국 관계형 DB를 사용하는 것이다.  
그렇기 때문에 많은 개발자들이 객체를 SQL로 바꾸어 DB에 저장하는  
반복되고 지루한 코드들을 작성하게 되고 있는게 현실이다.

* * *


## 객체와 관계형 데이터 베이스의 차이
### 1.상속

![image](https://user-images.githubusercontent.com/80972298/192113982-5255bb7a-b8d7-40f0-9d95-6c5232e5fbb4.png)

객체에는 상속관계가 있지만,관계형 DB에는 객체와 같은 구조의 상속관계가 없다.  
그나마 객체의 상속 관계와 유사한 모델인 TABLE 슈퍼타입 서브타입 논리 모델을 통해 모델링을 해도  
조회할때 너무나 복잡해 지는 문제가 발생한다.

### 2.연관관계

![image](https://user-images.githubusercontent.com/80972298/192114008-3398837e-cf89-44e0-9208-9e7690fc79b3.png)

객체는 참조를 사용:   
객체는 ```MEMBER``` 에서 ```TEAM``` 으로 조회 할 수 있지만 ```TEAM``` 에서 ```MEMBER``` 로는 조회 할 수 없다(단방향)   
테이블은 외래키를 사용:   
테이블은   ```TEAM_ID FK```  ```TEAM_ID PK``` 를 조인하여 ```MEMBER``` 에서 ```TEAM```으로 ```TEAM``` 에서 ```MEMBER```로 조회 할 수 있다(양방향)


### 3. 객체 그래프 탐색

![image](https://user-images.githubusercontent.com/80972298/192115166-6b48c444-226c-4fc1-83ff-419b496084db.png)


객체는 자유롭게 객체 그래프를 탐색할 수 있어야 한다.  
허나, SQL을 직접 다루면 처음 실행하는 SQL에 따라 객체 그래프 탐색 범위가 정해진다.  
왜냐하면,비즈니스 로직에 따라 사용하는 객체 그래프가 다른데,   
언제 끊어질지 모를 객체 그래프를 함부로 탐색할 수는 없기 때문이다


### 4.데이터 식별 방법

```JAVA
String memberId = "100";
Member member1 = memberDAO.getMember(memberId);
Member member2 = memberDAO.getMember(memberId);

member1 == member2;  // 다르다 

class MemberDAO {
 
 public Member getMember(String memberId) {
 String sql = "SELECT * FROM MEMBER WHERE MEMBER_ID = ?";
 ...
 //JDBC API, SQL 실행
 return new Member(...);
 }
}

```
여기서 member1 과 member2는 다르다 왜?  
memberDAO 코드를 까보면 SQL SELECT 쿼리를 날리는데 식별자가 같다고 해도 new MEMBER 로  
서로 다른 객체를 만들어 반환하기 때문이다.

자바 컬렉션에서 조회한다면?
```JAVA
Member member1 = list.get(memberId);
Member member2 = list.get(memberId);
member1 == member2;  //같다
```



### 객체를 자바 컬렉션에 저장하고 불러오듯이 DB에 저장할 수는 없을까?
자바 진영에서 그 고민의 결과가 ```JPA(JAVA Persistence API)``` 이다
